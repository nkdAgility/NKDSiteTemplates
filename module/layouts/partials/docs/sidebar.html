{{/* Get the docs section */}}
{{ $docsSection := .Site.GetPage "/docs" }}
{{ if $docsSection }}
  <nav class="docs-sidebar" aria-label="Documentation navigation">
    <div class="sidebar-header mb-3">
      <h5 class="text-primary fw-bold">
        <i class="fas fa-book me-2"></i>
        Documentation
      </h5>
    </div>

    <div class="sidebar-content">
      {{/* Render the docs navigation tree */}}
      {{ partial "docs/sidebar-tree.html" (dict "pages" $docsSection.Pages "current" . "level" 0) }}
    </div>
  </nav>

  <style>
    .docs-sidebar {
      position: sticky;
      top: 20px;
      max-height: calc(100vh - 40px);
      overflow-y: auto;
      padding: 1rem;
      background: var(--bs-light);
      border-radius: 0.375rem;
      border: 1px solid var(--bs-border-color);
    }

    [data-bs-theme="dark"] .docs-sidebar {
      background: var(--bs-dark);
      border-color: var(--bs-border-color);
    }

    .sidebar-nav {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-nav li {
      margin-bottom: 0.25rem;
    }
    .sidebar-nav a {
      display: block;
      padding: 0.375rem 0.75rem;
      color: var(--bs-body-color);
      text-decoration: none;
      border-radius: 0.25rem;
      transition: all 0.15s ease-in-out;
      font-size: 0.9rem;

      /* Prevent text wrapping and add ellipsis */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .sidebar-nav a:hover {
      background-color: var(--bs-primary);
      color: white;
    }

    .sidebar-nav a.active {
      background-color: var(--bs-primary);
      color: white;
      font-weight: 600;
    }

    .sidebar-nav .nav-level-1 {
      padding-left: 1rem;
    }

    .sidebar-nav .nav-level-2 {
      padding-left: 2rem;
    }

    .sidebar-nav .nav-level-3 {
      padding-left: 3rem;
    }

    .sidebar-section-title {
      font-weight: 600;
      color: var(--bs-primary);
      text-transform: uppercase;
      font-size: 0.8rem;
      letter-spacing: 0.5px;
      margin: 1rem 0 0.5rem 0;
      padding: 0 0.75rem;
    }
    .sidebar-section-title:first-child {
      margin-top: 0;
    } /* Dropdown-specific styles */
    .docs-dropdown-menu {
      max-height: 70vh;
      overflow-y: auto;
      padding: 0.5rem;
      border: 1px solid var(--bs-border-color);
      box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
      /* Prevent horizontal scroll on small screens */
      max-width: calc(100vw - 2rem);
      width: 100%;
    }

    .docs-dropdown-menu .docs-sidebar {
      background: transparent;
      border: none;
      padding: 0;
      position: static;
      max-height: none;
      overflow-y: visible;
    }

    .docs-dropdown-menu .sidebar-header {
      display: none;
    }

    /* Responsive adjustments for very small screens */
    @media (max-width: 575.98px) {
      .docs-dropdown-menu {
        max-width: calc(100vw - 1rem);
        padding: 0.25rem;
      }

      .docs-dropdown-menu .sidebar-nav a {
        font-size: 0.8rem;
        padding: 0.25rem 0.5rem;
      }
    }

    /* Make dropdown menu responsive */
    @media (max-width: 1199.98px) {
      .docs-dropdown-menu {
        left: 0 !important;
        right: 0 !important;
        transform: none !important;
      }
    }
  </style>
{{ end }}
